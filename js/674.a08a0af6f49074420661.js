"use strict";(self.webpackChunkautomation_analytics=self.webpackChunkautomation_analytics||[]).push([[674],{23674:(e,t,l)=>{l.r(t),l.d(t,{default:()=>O});var n=l(92950),a=l.n(n),r=l(45625),o=l(77388),u=l(48236),i=l(37384),s=l(9771),c=l(12613),d=l(44633),m=l(13784),E=l(86350),p=l(48716),_=l(39173),v=l(58788),f=l(87462),g=l(70885),b=l(45697),h=l.n(b),y=l(86445),T=l(53345),k=l(62455),Z=l(94592),x=l(65460),S={ok:x.global_palette_green_300.value,passed:x.global_palette_green_300.value,unreachable:x.global_palette_black_400.value,changed:x.global_palette_gold_300.value,failed:x.global_palette_red_100.value,skipped:x.global_palette_blue_300.value},C=function(e){var t,l,r,o,u,i,s,c=e.job,d=(0,n.useState)(!1),m=(0,g.Z)(d,2),E=m[0],p=m[1],_=c?{ok:null!==(t=null==c?void 0:c.ok_host_count)&&void 0!==t?t:0,skipped:null!==(l=null==c?void 0:c.skipped_host_count)&&void 0!==l?l:0,changed:null!==(r=null==c?void 0:c.changed_host_count)&&void 0!==r?r:0,failed:null!==(o=null==c?void 0:c.failed_host_count)&&void 0!==o?o:0,unreachable:null!==(u=null==c?void 0:c.unreachable_host_count)&&void 0!==u?u:0}:null,f=[{label:"Created",value:c.created?(0,T.o0)(c.created):"Unavailable"},{label:"Started",value:c.created?(0,T.o0)(c.started):"Unavailable"},{label:"Finished",value:c.created?(0,T.o0)(c.finished):"Unavailable"},{label:"Tasks",value:null!==(i=c.host_task_count)&&void 0!==i?i:0}];return a().createElement(a().Fragment,null,a().createElement(y.Tr,null,a().createElement(y.Td,{expand:{rowIndex:c.id.id,isExpanded:E,onToggle:function(){p(!E)}}}),a().createElement(y.Td,null,a().createElement("a",{href:c.id.tower_link},"".concat(c.id.id," - ").concat(c.id.template_name))),a().createElement(y.Td,null,a().createElement(k.Z,{status:null==c?void 0:c.status})),a().createElement(y.Td,null,null==c?void 0:c.cluster_name),a().createElement(y.Td,null,null==c?void 0:c.org_name),a().createElement(y.Td,null,(0,T.GV)(null==c?void 0:c.job_type))),a().createElement(y.Tr,{isExpanded:E},a().createElement(y.Td,{colSpan:6},a().createElement(y.ExpandableRowContent,null,a().createElement(v.Flex,null,a().createElement(v.FlexItem,null,a().createElement("strong",null,"Host status")),a().createElement(v.FlexItem,{align:{default:"alignRight"}},a().createElement("strong",null,"Hosts"),"  ",null!==(s=null==c?void 0:c.host_count)&&void 0!==s?s:0)),a().createElement(Z.Z,{categoryCount:_,categoryColor:S,showPercent:!0}),function(e){var t=(0,n.useState)(!1),l=(0,g.Z)(t,2),r=l[0],o=l[1];if(null!=e)return a().createElement(a().Fragment,null,a().createElement("p",null,a().createElement("strong",null,"Top failed tasks")),a().createElement(v.Grid,{hasGutter:!0},e.slice(0,r?e.length:2).map((function(e,t){var l,n,r,o={passed:null!==(l=null==e?void 0:e.passed_host_count)&&void 0!==l?l:0,failed:null!==(n=null==e?void 0:e.failed_host_count)&&void 0!==n?n:0,unreachable:null!==(r=null==e?void 0:e.unreachable_host_count)&&void 0!==r?r:0};return a().createElement(v.GridItem,{lg:6,md:12,key:"most-failed-".concat(t)},a().createElement(v.Flex,null,a().createElement(v.FlexItem,null,a().createElement("strong",null,"Task name ")," ",null==e?void 0:e.task_name),a().createElement(v.FlexItem,{align:{default:"alignRight"}},a().createElement("strong",null,"Module name ")," ",null==e?void 0:e.module_name)),a().createElement(Z.Z,{categoryCount:o,categoryColor:S,showPercent:!0}))}))),e.length>2?function(e,t){return a().createElement(v.Flex,{className:"pf-u-mb-md"},a().createElement(v.FlexItem,{align:{default:"alignRight"}},a().createElement(v.Button,{variant:"secondary",onClick:function(){t(!e)},fullWidth:{default:"fullWidth"}},e?"Show less":"Show more")))}(r,o):null)}(c.most_failed_tasks),a().createElement(v.DescriptionList,{isHorizontal:!0,columnModifier:{lg:"3Col"}},f.map((function(e){var t=e.label,l=e.value;return a().createElement(v.DescriptionListGroup,{key:t},a().createElement(v.DescriptionListTerm,null,t),a().createElement(v.DescriptionListDescription,null,l))})))))))};C.propTypes={job:h().object.isRequired};const P=C;var F=["Id/Name","Status","Cluster","Organization","Type"],q=["Id/Name","Status","Type"],j={0:"id",1:"status",4:"job_type"},I={id:0,status:1,job_type:4},R=function(e){var t=e.jobs,l=e.queryParams,r=e.queryParamsDispatch,o=(0,n.useState)(-1),u=(0,g.Z)(o,2),i=u[0],s=u[1],c=(0,n.useState)("none"),d=(0,g.Z)(c,2),m=d[0],E=d[1];(0,n.useEffect)((function(){(null==l?void 0:l.sort_options)in I?(s(I[l.sort_options]),E(null==l||!l.sort_order||"desc"!==l.sort_order&&"asc"!==l.sort_order?"desc":l.sort_order)):(s(-1),E("none"))}),[l]);var p=function(e,t,l){t!==i&&(s(t),r({type:"SET_SORT_OPTIONS",value:{sort_options:j[t]}})),l!==m&&(E(l),r({type:"SET_SORT_ORDER",value:{sort_order:l}}))};return a().createElement(y.TableComposable,{"aria-label":"Job Explorer Table",variant:"compact"},a().createElement(y.Thead,null,a().createElement(y.Tr,null,a().createElement(y.Th,null),F.map((function(e,t){var l=q.includes(e)?{sort:{sortBy:{index:i,direction:m},onSort:p,columnIndex:t}}:{};return a().createElement(y.Th,(0,f.Z)({key:"col-".concat(t)},l),e)})))),a().createElement(y.Tbody,null,t.map((function(e){return a().createElement(P,{job:e,key:e.id.id})}))))};R.propTypes={jobs:h().array.isRequired,queryParams:h().object.isRequired,queryParamsDispatch:h().func.isRequired};const w=R;var D=l(83474);const O=function(){var e=(0,r.Kx)(m.cY.defaultParams),t=e.queryParams,l=e.setFromPagination,f=e.setFromToolbar,g=e.dispatch,b=(0,o.ZP)((0,n.useCallback)((function(){return(0,d.ZW)(t)}),[t]),{}),h=b.result,y=b.error,T=b.request,k=(0,o.ZP)((0,n.useCallback)((function(){return(0,d.Ij)(t)}),[t]),{items:[],meta:{}}),Z=k.result,x=Z.items,S=Z.meta,C=k.isLoading,P=k.isSuccess,F=k.request;return(0,n.useEffect)((function(){T(),F()}),[t]),y?a().createElement(s.Z,{message:y.error}):a().createElement(a().Fragment,null,a().createElement(p.Z,null,a().createElement(_.Z,{title:"Job Explorer"})),a().createElement(E.Z,null,a().createElement(v.Card,null,a().createElement(v.CardBody,null,a().createElement(D.Z,{categories:h,filters:t,setFilters:f,pagination:a().createElement(c.Z,{count:null==S?void 0:S.count,params:{limit:+t.limit,offset:+t.offset},setPagination:l,isCompact:!0}),hasSettings:!0}),C&&a().createElement(u.Z,null),P&&x.length<=0&&a().createElement(i.Z,null),P&&x.length>0&&a().createElement(w,{jobs:x,queryParams:t,queryParamsDispatch:g}),a().createElement(c.Z,{count:null==S?void 0:S.count,params:{limit:+t.limit,offset:+t.offset},setPagination:l,variant:v.PaginationVariant.bottom})))))}}}]);
//# sourceMappingURL=../sourcemaps/674.6cf7a5bb2c55fb799f9081ad12be5453.js.map